
# Конспект

## API/Контракт

**API (Application Programming Interface)** — это набор функциональности, предоставляемый библиотекой, приложением, фреймворком или утилитой, который может использоваться другим приложением или библиотекой.

## REST API

**REST API** — это набор HTTP-методов, которые можно вызывать на сервере, оформленный по определенным правилам.

### В чем суть?

Рассмотрим пример с веб-страницей со списком продуктов. Пользователь может зайти на эту страницу, посмотреть список продуктов и выбрать один для более подробного изучения.

Как это будет работать с точки зрения REST API:

Frontend-разработчики создают две страницы: одна содержит список товаров, другая — информацию по конкретному товару. Эти страницы загружаются в браузер пользователя.

### Как получить данные?

Frontend- и Backend-разработчики договариваются о двух запросах:

1. `GET /products` — получение всех товаров в формате JSON.

   Пример ответа:

   ```json
   {
     "products": [
       { "id": 10, "name": "Молоко", "price": 10 },
       { "id": 11, "name": "Хлеб", "price": 15 },
       { "id": 12, "name": "Мясо", "price": 20 }
     ]
   }
   ```

2. `GET /products/{id}` — получение конкретного товара по ID.

   Пример ответа:

   ```json
   {
     "id": 10,
     "name": "Молоко",
     "price": 10,
     "description": "Классное молоко!",
     "count": 5,
     "image": "https://images.amazon.com/2343231.jpg"
   }
   ```

Важно, чтобы разработчики договорились о формате передачи данных.

### Что такое REST?

**REST** — это набор требований, которым можно следовать для улучшения взаимодействия в API.

Основные требования REST:

1. **Ресурсо-ориентированное именование эндпоинтов:**

   - `/products` — все продукты
   - `/products/{id}` — конкретный продукт
   - `/products/{id}/recommendations` — рекомендации для конкретного продукта
   - `/users/10/friends` — друзья пользователя с ID 10

   Неправильные примеры:

   - `/friendsOf10User`
   - `/getAllFriends/10`

2. **Использование JSON** (XML или просто текст не используются).

3. **Использование HTTP-методов вместо глаголов в URL:**

   - Нельзя: `POST /users/10/update` с телом `{newName: "Marsel"}`
   - Можно: `PUT /users/10` с телом `{newName: "Marsel"}`

4. **Использование статусов ответов:**

   - `200 OK` — запрос успешен
   - `404 Not Found` — ресурс не найден
   - `500 Internal Server Error` — ошибка сервера (никогда не возвращаем специально)
   - `401 Unauthorized / 403 Forbidden` — не авторизован/запрещено
   - `201 Created` — ресурс создан (ответ на POST-запрос)

### Как реализовать Backend API с использованием Spring/Spring Boot и Java?

Для реализации контроллеров в Spring используется:

- `@RestController` — аннотация, указывающая, что класс является контроллером и может обрабатывать HTTP-запросы и возвращать JSON.
- `@RequestMapping("/products")` — указывает, что все запросы, обрабатываемые этим контроллером, начинаются с URL `/products`.

Контроллеры содержат методы, каждый из которых обрабатывает определенный тип запроса, например:

- `@GetMapping` — обработка GET-запросов.
- `@PostMapping` — обработка POST-запросов.
- `@PutMapping` — обработка PUT-запросов.
- `@DeleteMapping` — обработка DELETE-запросов.

### Примеры эндпоинтов

- `POST /products` — добавление продукта.
- `GET /products` — получение списка продуктов.
- `PUT /products` — обновление продукта.
- `DELETE /products` — удаление продукта.
- `PUT /products/restore` — восстановление продукта.
- `GET /products/quantity` — получение количества продуктов.

### Работа с параметрами и телом запроса

- `@RequestBody` — аннотация, указывающая на необходимость преобразования тела запроса из JSON.
- `@RequestParam(required = false) Long id` — параметр может быть передан в URL-запросе, но не является обязательным.

Пример запроса: `GET /products?id=10&title=Hello`
